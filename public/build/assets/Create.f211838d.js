import{A as O}from"./AdminLayout.b04e21d6.js";import{L as j,H as q,a as V,o as d,c as r,f as u,w as U,F as c,d as e,j as p,k as n,m as b,g as f,v as _,i as w,p as T,t as g,e as k}from"./app.1a291d6d.js";import{P as x}from"./Pagination.35641abc.js";import{V as P}from"./ValidationError.1d6dd248.js";import{_ as D}from"./_plugin-vue_export-helper.cdc0426e.js";const S={components:{AdminLayout:O,Link:j,Pagination:x,ValidationError:P,Head:q},props:["roles","filials","teachers","trainTypes","courseTypes","subjects","shifts"],data(){return{user:{image:"",role_id:"",filial_id:"",start_date:null},image:{file:"",preview:""},eduOrders:[{subject_id:"",teacher_id:"",shift_id:1,course_type_id:1,train_type_id:1,price:0,start_date:null,end_date:null}],teacherOrders:this.trainTypes,subjectOrders:null,iin:""}},methods:{warningText(i,o="\u0411\u0430\u0440\u043B\u044B\u049B \u0431\u0430\u0493\u0430\u043D\u0434\u0430\u0440 \u0442\u043E\u043B\u0442\u044B\u0440\u0443 \u049B\u0430\u0436\u0435\u0442!"){Swal.fire({title:i,text:o,icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"\u041E\u043A\u0435\u0439!"})},deleteOrder(i){this.eduOrders.splice(i,1)},calculatePrice(i,o=null){if(!this.eduOrders[i].subject_id)return this.warningText("\u041F\u0440\u0435\u0434\u043C\u0435\u0442 \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D!",null);o?axios.get(`/subject/${this.eduOrders[i].subject_id}/get-subject-order`).then(a=>{this.subjectOrders=a.data,this.eduOrders[i].price=this.subjectOrders.find(y=>y.course_type_id==this.eduOrders[i].course_type_id&&y.shift_id==this.eduOrders[i].shift_id&&y.train_type_id==this.eduOrders[i].train_type_id).price}):this.eduOrders[i].price=this.subjectOrders.find(a=>a.course_type_id==this.eduOrders[i].course_type_id&&a.shift_id==this.eduOrders[i].shift_id&&a.train_type_id==this.eduOrders[i].train_type_id).price},add28Days(i){if(this.eduOrders[i].start_date){const o=new Date(this.eduOrders[i].start_date),a=new Date(o.getTime()+28*24*60*60*1e3);this.eduOrders[i].end_date=a.toISOString().split("T")[0]}else console.error("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443")},addEduOrder(){const i={subject_id:"",teacher_id:"",course_type_id:1,train_type_id:1,price:0,start_date:null,end_date:null};this.eduOrders.push(i)},submit(){if(this.user.iin=this.iin,this.image.file&&(this.user.image=this.image.file),!this.user.role_id)return this.warningText("\u0420\u043E\u043B\u044C \u0442\u0430\u043D\u0434\u0430\u043B\u043C\u0430\u0434\u044B!");if(!this.user.filial_id)return this.warningText("\u0424\u0438\u043B\u0438\u0430\u043B \u0442\u0430\u043D\u0434\u0430\u043B\u043C\u0430\u0434\u044B!");this.user.role_id==4&&(this.user.eduOrders=this.eduOrders),this.user.role_id==3&&(this.user.eduOrders=this.teacherOrders),this.$inertia.post(route("admin.users.store"),this.user,{onError:()=>console.log("An error has occurred"),onSuccess:()=>console.log("The new contact has been saved")})},handleImageUpload(){if(this.image.file=this.$refs.image.files[0],this.image.file){const i=new FileReader;i.onloadend=o=>{this.image.preview=i.result},i.readAsDataURL(this.image.file),this.$refs.image.value=""}else this.user.image="",this.image.file="",this.image.preview=""},checkIin(){this.warningText("\u0411\u04B1\u043D\u0434\u0430\u0439 \u0418\u0418\u041D \u0431\u04B1\u0440\u044B\u043D \u0442\u0456\u0440\u043A\u0435\u043B\u0433\u0435\u043D",null)}},watch:{iin(i){i.length===12&&this.checkIin()}}},L=e("head",null,[e("title",null,"\u0410\u0434\u043C\u0438\u043D \u043F\u0430\u043D\u0435\u043B\u044C | \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443")],-1),A={class:"row mb-2"},B=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"\u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443")],-1),E={class:"col-sm-6"},I={class:"breadcrumb float-sm-right"},N={class:"breadcrumb-item"},F=["href"],M=e("i",{class:"fas fa-dashboard"},null,-1),H=k(" \u0411\u0430\u0441\u0442\u044B \u0431\u0435\u0442 "),R=[M,H],z={class:"breadcrumb-item"},G=["href"],J=e("i",{class:"fas fa-dashboard"},null,-1),K=k(" \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u0442\u0456\u0437\u0456\u043C\u0456 "),Q=[J,K],W=e("li",{class:"breadcrumb-item active"}," \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443 ",-1),X={class:"container-fluid"},Y={class:"card card-primary"},Z={class:"card-body"},$={class:"row"},ee={class:"col-md-4"},se={class:"form-group"},te=e("label",{for:""},"\u0420\u043E\u043B\u044C",-1),oe=e("option",{value:"",hidden:""}," \u0420\u043E\u043B\u044C \u0442\u0430\u04A3\u0434\u0430\u04A3\u044B\u0437 ",-1),ie=["value"],le={class:"col-md-4"},de={class:"form-group"},re=e("label",{for:""},"\u0424\u0438\u043B\u043B\u0438\u0430\u043B",-1),ne=e("option",{value:"",hidden:"",disabled:"",selected:""}," \u0424\u0438\u043B\u043B\u0438\u0430\u043B \u0442\u0430\u04A3\u0434\u0430\u04A3\u044B\u0437 ",-1),ae=["value"],ce={class:"col-md-4"},_e={class:"form-group"},ue=e("label",{for:""},"\u049A\u04B1\u043F\u0438\u044F \u0441\u04E9\u0437",-1),he={class:"row"},me={class:"col-md-4"},pe={class:"form-group"},fe=e("label",{for:""},"\u0418\u0418\u041D",-1),ve={class:"row"},ge={class:"col-md-4"},be={class:"form-group"},ye=e("label",{for:""},"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",-1),we={class:"col-md-4"},Ve={class:"form-group"},Ue=e("label",{for:""},"\u0418\u043C\u044F",-1),ke={class:"row"},Ce={class:"col-md-4"},Oe={class:"form-group"},je=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u044C\u044F",-1),qe={class:"col-md-4"},Te={class:"form-group"},xe=e("label",{for:""},"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",-1),Pe={class:"col-md-4"},De={class:"form-group"},Se=e("label",{for:""},"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B\u044F",-1),Le={class:"form-group file-upload"},Ae=e("label",{for:""},"\u0421\u0443\u0440\u0435\u0442",-1),Be={class:"ml-2"},Ee=["src"],Ie=["src"],Ne={class:"file-input",style:{"margin-right":"10px"}},Fe=e("label",{for:"image"}," \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C ",-1),Me={key:0,class:"mt-5"},He=e("hr",null,null,-1),Re={class:"row"},ze={class:"col-md-4"},Ge={class:"form-group"},Je=e("label",{for:""},"\u041F\u0440\u0435\u0434\u043C\u0435\u0442",-1),Ke=["onChange","onUpdate:modelValue"],Qe=e("option",{value:"",hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),We=["value"],Xe={class:"col-md-4"},Ye={class:"form-group"},Ze=e("label",{for:""},"\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044C",-1),$e=["onUpdate:modelValue"],es=e("option",{value:"",hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),ss=["value"],ts={class:"col-md-4"},os={class:"form-group"},is=e("label",{for:""},"\u0422\u0438\u043F \u043F\u043E\u0441\u0435\u0449\u0435\u043D\u0438\u044F",-1),ls=["onUpdate:modelValue","onChange"],ds=e("option",{value:"",hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),rs=["value"],ns={class:"row"},as={class:"col-md-4"},cs={class:"form-group"},_s=e("label",{for:""},"\u041A\u0443\u0440\u0441",-1),us=["onChange","onUpdate:modelValue"],hs=e("option",{value:null,hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),ms=["value"],ps={class:"col-md-4"},fs={class:"form-group"},vs=e("label",{for:""},"\u041E\u0431\u0443\u0447\u0435\u043D\u0438\u0435",-1),gs=["onChange","onUpdate:modelValue"],bs=e("option",{value:null,hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),ys=["value"],ws={class:"col-md-4"},Vs={class:"form-group"},Us=e("label",{for:""},"\u0426\u0435\u043D\u0430",-1),ks=["onUpdate:modelValue"],Cs={class:"row"},Os={class:"col-md-4"},js={class:"form-group"},qs=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u043E \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),Ts=["onChange","onUpdate:modelValue"],xs={class:"col-md-4"},Ps={class:"form-group"},Ds=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043A\u043E\u043D\u0446\u0430 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),Ss=["onUpdate:modelValue"],Ls={class:"d-flex justify-content-end"},As=["onClick"],Bs=e("i",{class:"fas fa-times"},null,-1),Es=[Bs],Is={class:"row"},Ns={class:"col-md-5"},Fs={class:"form-group"},Ms=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u043E \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),Hs={class:"row"},Rs={class:"col-md-5"},zs={class:"form-group"},Gs=e("label",{for:""},"\u0417\u0430\u0440\u043F\u043B\u0430\u0442\u0430",-1),Js={class:"input-group mt-3"},Ks={class:"input-group-prepend"},Qs={class:"input-group-text",id:"basic-addon3"},Ws=["onUpdate:modelValue"],Xs=e("div",{class:"input-group-append"},[e("span",{class:"input-group-text"},"%")],-1),Ys={class:"card-footer mt-5"},Zs=e("button",{type:"submit",class:"btn btn-success mr-1"}," \u0421\u0430\u049B\u0442\u0430\u0443 ",-1);function $s(i,o,a,y,l,h){const m=V("validation-error"),C=V("AdminLayout");return d(),r(c,null,[L,u(C,null,{breadcrumbs:U(()=>[e("div",A,[B,e("div",E,[e("ol",I,[e("li",N,[e("a",{href:i.route("admin.index")},R,8,F)]),e("li",z,[e("a",{href:i.route("admin.users.index")},Q,8,G)]),W])])])]),default:U(()=>[e("div",X,[e("div",Y,[e("form",{method:"post",onSubmit:o[13]||(o[13]=p((...s)=>h.submit&&h.submit(...s),["prevent"]))},[e("div",Z,[e("div",$,[e("div",ee,[e("div",se,[te,n(e("select",{class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>l.user.role_id=s),placeholder:"\u0411\u0435\u043B\u0441\u0435\u043D\u0434\u0456",required:""},[oe,(d(!0),r(c,null,f(a.roles,s=>(d(),r("option",{key:"role"+s.id,value:s.id},g(s.name),9,ie))),128))],512),[[b,l.user.role_id]]),u(m,{field:"role_id"})])]),e("div",le,[e("div",de,[re,n(e("select",{class:"form-control","onUpdate:modelValue":o[1]||(o[1]=s=>l.user.filial_id=s),placeholder:"\u0411\u0435\u043B\u0441\u0435\u043D\u0434\u0456",required:""},[ne,(d(!0),r(c,null,f(a.filials,s=>(d(),r("option",{key:"filial"+s.id,value:s.id},g(s.name),9,ae))),128))],512),[[b,l.user.filial_id]]),u(m,{field:"filial_id"})])]),e("div",ce,[e("div",_e,[ue,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[2]||(o[2]=s=>l.user.real_password=s),name:"real_password",placeholder:"\u049A\u04B1\u043F\u0438\u044F \u0441\u04E9\u0437"},null,512),[[_,l.user.real_password]]),u(m,{field:"real_password"})])])]),e("div",he,[e("div",me,[e("div",pe,[fe,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[3]||(o[3]=s=>l.iin=s),name:"iin",placeholder:"\u0418\u0418\u041D",required:""},null,512),[[_,l.iin]]),u(m,{field:"iin"})])])]),e("div",ve,[e("div",ge,[e("div",be,[ye,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[4]||(o[4]=s=>l.user.s_name=s),name:"s_name",placeholder:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",required:""},null,512),[[_,l.user.s_name]]),u(m,{field:"s_name"})])]),e("div",we,[e("div",Ve,[Ue,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[5]||(o[5]=s=>l.user.name=s),name:"name",placeholder:"\u0418\u043C\u044F",required:""},null,512),[[_,l.user.name]]),u(m,{field:"name"})])])]),e("div",ke,[e("div",Ce,[e("div",Oe,[je,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":o[6]||(o[6]=s=>l.user.birthday=s),name:"birthday",placeholder:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",required:""},null,512),[[_,l.user.birthday]]),u(m,{field:"birthday"})])]),e("div",qe,[e("div",Te,[xe,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[7]||(o[7]=s=>l.user.tel_num=s),name:"tel_num",placeholder:"\u0418\u043C\u044F",required:""},null,512),[[_,l.user.tel_num]]),u(m,{field:"tel_num"})])]),e("div",Pe,[e("div",De,[Se,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o[8]||(o[8]=s=>l.user.tel_num_family=s),name:"tel_num_family",placeholder:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B\u044F"},null,512),[[_,l.user.tel_num_family]]),u(m,{field:"tel_num_family"})])])]),e("div",Le,[Ae,e("div",Be,[l.user.image&&!l.image.file?(d(),r("img",{key:0,src:i.route("index")+"/storage/images/"+l.user.image,height:"300",alt:"image",style:{"padding-bottom":"10px"}},null,8,Ee)):w("",!0),n(e("img",{src:l.image.preview,height:"300",style:{"padding-bottom":"10px"}},null,8,Ie),[[T,l.image.preview]]),e("div",Ne,[e("input",{type:"file",hidden:"",name:"image",onChange:o[9]||(o[9]=s=>h.handleImageUpload()),ref:"image",accept:"image/jpeg,image/png",class:"file",id:"image"},null,544),Fe])]),u(m,{field:"image"})]),l.user.role_id==3||l.user.role_id==4?(d(),r("h2",Me,"\u041E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")):w("",!0),l.user.role_id==4?(d(!0),r(c,{key:1},f(l.eduOrders,(s,v)=>(d(),r(c,null,[He,e("div",Re,[e("div",ze,[e("div",Ge,[Je,n(e("select",{class:"form-control",onChange:p(t=>h.calculatePrice(v,!0),["prevent"]),"onUpdate:modelValue":t=>s.subject_id=t,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[Qe,(d(!0),r(c,null,f(a.subjects,t=>(d(),r("option",{key:"subject"+t.id,value:t.id},g(t.name),9,We))),128))],40,Ke),[[b,s.subject_id]])])]),e("div",Xe,[e("div",Ye,[Ze,n(e("select",{class:"form-control","onUpdate:modelValue":t=>s.teacher_id=t,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[es,(d(!0),r(c,null,f(a.teachers,t=>(d(),r("option",{key:"teacher"+t.id,value:t.id},g(t.fio),9,ss))),128))],8,$e),[[b,s.teacher_id]])])]),e("div",ts,[e("div",os,[is,n(e("select",{class:"form-control","onUpdate:modelValue":t=>s.shift_id=t,onChange:p(t=>h.calculatePrice(v),["prevent"]),placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[ds,(d(!0),r(c,null,f(a.shifts,t=>(d(),r("option",{key:"shift"+t.id,value:t.id},g(t.name),9,rs))),128))],40,ls),[[b,s.shift_id]])])])]),e("div",ns,[e("div",as,[e("div",cs,[_s,n(e("select",{class:"form-control",onChange:p(t=>h.calculatePrice(v),["prevent"]),"onUpdate:modelValue":t=>s.course_type_id=t,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[hs,(d(!0),r(c,null,f(a.courseTypes,t=>(d(),r("option",{key:"courseType"+t.id,value:t.id},g(t.name),9,ms))),128))],40,us),[[b,s.course_type_id]])])]),e("div",ps,[e("div",fs,[vs,n(e("select",{class:"form-control",onChange:p(t=>h.calculatePrice(v),["prevent"]),"onUpdate:modelValue":t=>s.train_type_id=t,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[bs,(d(!0),r(c,null,f(a.trainTypes,t=>(d(),r("option",{key:"trainType"+t.id,value:t.id},g(t.name),9,ys))),128))],40,gs),[[b,s.train_type_id]])])]),e("div",ws,[e("div",Vs,[Us,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t=>s.price=t,name:"eduOrderPrice",placeholder:"\u0426\u0435\u043D\u0430"},null,8,ks),[[_,s.price]])])])]),e("div",Cs,[e("div",Os,[e("div",js,[qs,n(e("input",{type:"date",class:"form-control",onChange:p(t=>h.add28Days(v),["prevent"]),"onUpdate:modelValue":t=>s.start_date=t,name:"eduOrderPrice",required:""},null,40,Ts),[[_,s.start_date]])])]),e("div",xs,[e("div",Ps,[Ds,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t=>s.end_date=t,name:"eduOrderPrice",required:""},null,8,Ss),[[_,s.end_date]])])])]),e("div",Ls,[e("button",{onClick:p(t=>h.deleteOrder(v),["prevent"]),class:"btn btn-danger mt-4"},Es,8,As)]),e("button",{onClick:o[10]||(o[10]=p(t=>h.addEduOrder(),["prevent"])),class:"btn btn-primary mt-4"}," + \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F ")],64))),256)):w("",!0),l.user.role_id==3?(d(),r(c,{key:2},[e("div",Is,[e("div",Ns,[e("div",Fs,[Ms,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":o[11]||(o[11]=s=>l.user.start_date=s),required:""},null,512),[[_,l.user.start_date]])])])]),e("div",Hs,[e("div",Rs,[e("div",zs,[Gs,(d(!0),r(c,null,f(l.teacherOrders,s=>(d(),r("div",Js,[e("div",Ks,[e("span",Qs,g(s.name),1)]),n(e("input",{type:"number",class:"form-control","onUpdate:modelValue":v=>s.percent=v,"aria-describedby":"basic-addon3",style:{"text-align":"right"},required:""},null,8,Ws),[[_,s.percent]]),Xs]))),256))])])])],64)):w("",!0),e("div",Ys,[Zs,e("button",{type:"button",class:"btn btn-danger",onClick:o[12]||(o[12]=p(s=>i.back(),["prevent"]))}," \u0410\u0440\u0442\u049B\u0430 ")])])],32)])])]),_:1})],64)}const lt=D(S,[["render",$s]]);export{lt as default};
