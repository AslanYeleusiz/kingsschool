import{A as G}from"./AdminLayout.d435aff3.js";import{L,H as T,a as P,o as e,c as n,f as g,w as f,F as m,d as t,t as d,b as w,h as _,m as k,u as B,v as x,p as A,g as p,e as b,q as S,s as D,l as y}from"./app.a69c65d8.js";import{P as V}from"./Pagination.cfbc7211.js";import{_ as N}from"./_plugin-vue_export-helper.cdc0426e.js";const I={components:{AdminLayout:G,Link:L,Pagination:V,Head:T},props:["orders","groups","user","teacher"],data(){return{filter:{name:route().params.name?route().params.name:null},loading:0,newGroup:"",allPrice:0,newAllPrice:0}},methods:{calculatePrice(o,i){return this.orders.data.reduce((h,r)=>o==2&&r.lastEduPaid.status==3||r.lastEduPaid&&r.lastEduPaid.status==o?h+(i?r.newPrice:r.price):h,0)},calculateAllPrice(o){return this.orders.data.reduce((l,h)=>l+(o?h.newPrice:h.price),0)},checkStudents(){return this.user.role_id==1?!1:this.orders.data.every(o=>o.group_id!==null)==!1},setNewGroup(o,i=null){this.$inertia.put(route("admin.students.update",o),{name:this.newGroup,groupId:i})},setGroup(o,i=null){this.orders.data.find(l=>l.id==o).group_id==0?this.newGroup="":this.setNewGroup(o,i)},setPaid(o,i){if(i)Swal.fire({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043E\u043F\u043B\u0430\u0442\u0443",icon:"success",showCancelButton:!0,confirmButtonColor:"#71DD37",cancelButtonColor:"#adb5bd",confirmButtonText:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancelButtonText:"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C"}).then(l=>{l.isConfirmed&&this.$inertia.post(route("admin.students.paid",o))});else{if(this.orders.data.find(h=>h.id==o).lastEduPaid.is_paid)return Swal.fire({title:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E!",text:"\u041E\u043F\u043B\u0430\u0442\u0430 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430, \u0442\u0430\u043A \u043A\u0430\u043A \u0437\u0430\u0440\u043F\u043B\u0430\u0442\u0430 \u0431\u044B\u043B\u0430 \u0432\u044B\u0434\u0430\u043D\u0430 \u0443\u0447\u0438\u0442\u0435\u043B\u044E!",icon:"error"});Swal.fire({title:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043E\u043F\u043B\u0430\u0442\u0443?",icon:"error",showCancelButton:!0,confirmButtonColor:"#71DD37",cancelButtonColor:"#adb5bd",confirmButtonText:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancelButtonText:"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C"}).then(h=>{h.isConfirmed&&this.$inertia.post(route("admin.students.deletePaid",o))})}},search(){this.loading=1;const o=this.clearParams(this.filter);this.$inertia.get(route("admin.students.index"),o)},deleteData(o){Swal.fire({title:"\u0416\u043E\u044E\u0493\u0430 \u0441\u0435\u043D\u0456\u043C\u0434\u0456\u0441\u0456\u0437 \u0431\u0435?",text:"\u049A\u0430\u0439\u0442\u044B\u043F \u049B\u0430\u043B\u043F\u044B\u043D\u0430 \u043A\u0435\u043B\u043C\u0435\u0443\u0456 \u043C\u04AF\u043C\u043A\u0456\u043D!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u0418\u04D9, \u0436\u043E\u044F\u043C\u044B\u043D!",cancelButtonText:"\u0416\u043E\u049B"}).then(i=>{i.isConfirmed&&this.$inertia.delete(route("admin.groups.destroy",o))})},deleteDataAtGroup(o){Swal.fire({title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0447\u0435\u043D\u0438\u043A\u0430 \u0438\u0437 \u0433\u0440\u0443\u043F\u043F\u044B?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u0414\u0430!",cancelButtonText:"\u041D\u0435\u0442"}).then(i=>{i.isConfirmed&&this.$inertia.delete(route("admin.groups.destroyOrder",o))})}}},F=t("head",null,[t("title",null,"\u0410\u0434\u043C\u0438\u043D \u043F\u0430\u043D\u0435\u043B\u044C | \u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B")],-1),U={class:"row mb-2"},M={class:"col-sm-6"},H={class:"m-0"},K={class:"col-sm-6"},q={class:"breadcrumb float-sm-right"},z={class:"breadcrumb-item"},O=["href"],R=t("i",{class:"fas fa-dashboard"},null,-1),W=b(" \u0411\u0430\u0441\u0442\u044B \u0431\u0435\u0442 "),J=[R,W],Q=t("li",{class:"breadcrumb-item active"}," \u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B ",-1),X={class:"buttons d-flex align-items-center"},Y=t("i",{class:"fa fa-plus"},null,-1),Z=b(" \u049A\u043E\u0441\u0443 "),$=t("i",{class:"fa fa-trash"},null,-1),tt=b(" \u0424\u0438\u043B\u044C\u0442\u0440\u0434\u0456 \u0442\u0430\u0437\u0430\u043B\u0430\u0443 "),st=b(" \u041E\u0442\u0447\u0451\u0442 \u0434\u043B\u044F \u0432\u044B\u0434\u0430\u0447\u0438 \u0437\u0430\u0440\u043F\u043B\u0430\u0442\u044B "),et=b(" \u041F\u043E\u043B\u043D\u044B\u0439 \u043E\u0442\u0447\u0451\u0442 "),lt={key:3,class:"ml-2 badge badge-danger"},nt={class:"container-fluid"},ot={class:"card"},dt={class:"card-body"},it={class:"row"},at={class:"col-sm-12"},ct={class:"table table-hover table-bordered table-striped dataTable dtr-inline"},ut={role:"row"},_t=t("th",null,"\u2116",-1),rt=t("th",null,null,-1),ht=t("th",null,"\u0424\u0418\u041E",-1),ft=t("th",null,"\u041F\u0440\u0435\u0434\u043C\u0435\u0442",-1),mt=t("th",null,"\u0421\u0442\u0430\u0442\u0443\u0441",-1),vt={key:0},kt=t("th",null,"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",-1),bt={key:1},gt={key:2},pt={class:"filters"},yt=t("td",null,null,-1),Ct=t("td",null,null,-1),Pt=t("td",null,null,-1),wt={key:0},Bt=t("td",null,null,-1),xt={key:1},St={key:2},jt=t("td",null,null,-1),Et={class:"d-f aj-c"},Gt={class:"d-f j-c"},Lt={class:"paidBlock"},Tt=["onClick"],At=["onClick"],Dt=["onClick"],Vt={class:"paid date"},Nt={key:0},It={class:"d-f j-c"},Ft={class:"tablemask",title:"\u041D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u043F\u043E Whatsapp"},Ut={key:1},Mt={class:"d-f j-c"},Ht={class:"paidBlock"},Kt={key:0,class:"paid success no-hover"},qt=["onClick"],zt=["onClick"],Ot={class:"paid date no-hover"},Rt={key:0},Wt=["onChange","onUpdate:modelValue"],Jt=t("option",{value:null,hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),Qt=t("option",{value:0}," + \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0433\u0440\u0443\u043F\u043F\u0443 ",-1),Xt=["value"],Yt={key:1},Zt=["onFocusout"],$t={class:"btn-group btn-group-sm"},ts=t("i",{class:"fas fa-edit"},null,-1),ss={class:"odd"},es=t("td",null,null,-1),ls=t("td",null,null,-1),ns=t("td",null,null,-1),os=t("td",null,null,-1),ds=t("td",null,null,-1),is=t("td",null,null,-1),as=t("td",null,"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",-1),cs={class:"d-f j-c"},us={class:"paidBlock"},_s={class:"paid success no-hover"},rs={class:"paid date no-hover"},hs=t("td",null,null,-1),fs=t("td",null,null,-1),ms={class:"odd"},vs=t("td",null,null,-1),ks=t("td",null,null,-1),bs=t("td",null,null,-1),gs=t("td",null,null,-1),ps=t("td",null,null,-1),ys=t("td",null,null,-1),Cs=t("td",null,"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",-1),Ps={class:"d-f j-c"},ws={class:"paidBlock"},Bs={class:"paid pd danger no-hover"},xs={class:"paid date no-hover"},Ss=t("td",null,null,-1),js=t("td",null,null,-1),Es={class:"odd"},Gs=t("td",null,null,-1),Ls=t("td",null,null,-1),Ts=t("td",null,null,-1),As=t("td",null,null,-1),Ds=t("td",null,null,-1),Vs=t("td",null,null,-1),Ns=t("td",null,"\u041E\u0431\u0449\u0435\u0435",-1),Is={class:"d-f j-c"},Fs={class:"paidBlock"},Us={class:"paid pd danger no-hover"},Ms={class:"paid date no-hover"},Hs=t("td",null,null,-1),Ks=t("td",null,null,-1),qs={key:0,class:"container-fluid"},zs={class:"card"},Os={class:"card-body"},Rs=t("h2",{class:"mb-3"},"\u0413\u0440\u0443\u043F\u043F\u044B",-1),Ws={class:"row"},Js={class:"col-sm-12"},Qs=["data-target"],Xs={class:"d-flex center"},Ys={class:"d-flex gap-20"},Zs={class:"mr-3 modul_name"},$s=["onClick"],te=t("i",{class:"fas fa-times"},null,-1),se=[te],ee=t("span",{class:"arrow mr-3"},"\u25BC",-1),le=["id"],ne={class:"table table-hover table-bordered table-striped dataTable dtr-inline"},oe=t("thead",null,[t("tr",{role:"row"},[t("th",null,"\u2116"),t("th"),t("th",null,"\u0424\u0418\u041E"),t("th",null,"\u041F\u0440\u0435\u0434\u043C\u0435\u0442"),t("th",null,"\u0421\u0442\u0430\u0442\u0443\u0441"),t("td")])],-1),de={class:"d-f aj-c"},ie={class:"d-f j-c"},ae={class:"paidBlock"},ce=["onClick"],ue=["onClick"],_e=["onClick"],re={class:"paid date"},he={class:"d-f j-b"},fe=t("div",null,null,-1),me=["onClick"],ve=t("i",{class:"fas fa-times"},null,-1),ke=[ve];function be(o,i,l,h,r,a){const v=P("Link"),j=P("Pagination"),E=P("AdminLayout");return e(),n(m,null,[F,g(E,null,{breadcrumbs:f(()=>{var s;return[t("div",U,[t("div",M,[t("h1",H,"\u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B "+d((s=l.teacher)==null?void 0:s.fio),1)]),t("div",K,[t("ol",q,[t("li",z,[t("a",{href:o.route("admin.index")},J,8,O)]),Q])])])]}),header:f(()=>[t("div",X,[l.user.role_id==1||l.user.role_id==2?(e(),w(v,{key:0,class:"btn btn-primary mr-2",href:o.route("admin.users.create")},{default:f(()=>[Y,Z]),_:1},8,["href"])):_("",!0),g(v,{class:"btn btn-danger",href:o.route("admin.students.index")},{default:f(()=>[$,tt]),_:1},8,["href"]),l.groups?(e(),w(v,{key:1,class:"btn btn-success ml-2",href:o.route("admin.teachers.reports",o.route().params.teacher_id)},{default:f(()=>[st]),_:1},8,["href"])):_("",!0),l.groups?(e(),w(v,{key:2,class:"btn btn-success ml-2",href:o.route("admin.teachers.fullReports",o.route().params.teacher_id)},{default:f(()=>[et]),_:1},8,["href"])):_("",!0),a.checkStudents()?(e(),n("div",lt,[t("h3",null,d(l.groups?"\u0412\u0430\u0448\u0438":"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435")+" \u0441\u0442\u0443\u0434\u0435\u043D\u0442\u044B \u043D\u0435 \u0440\u0430\u0441\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u044B \u043F\u043E \u0433\u0440\u0443\u043F\u043F\u0430\u043C",1)])):_("",!0)])]),default:f(()=>[t("div",nt,[t("div",ot,[t("div",dt,[t("div",it,[t("div",at,[t("table",ct,[t("thead",null,[t("tr",ut,[_t,rt,ht,ft,mt,l.user.role_id<3?(e(),n("th",vt,"\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044C")):_("",!0),kt,l.user.role_id<3?(e(),n("th",bt,"\u0426\u0435\u043D\u0430")):_("",!0),l.groups?(e(),n("th",gt,"\u0413\u0440\u0443\u043F\u043F\u0430")):_("",!0),k(t("th",null,null,512),[[B,l.user.role_id==1||l.user.role_id==2]])]),t("tr",pt,[yt,Ct,t("td",null,[k(t("input",{"onUpdate:modelValue":i[0]||(i[0]=s=>r.filter.fio=s),class:"form-control",placeholder:"\u0424\u0418\u041E",onKeyup:i[1]||(i[1]=A((...s)=>a.search&&a.search(...s),["enter"]))},null,544),[[x,r.filter.fio]])]),Pt,l.user.role_id<3?(e(),n("td",wt)):_("",!0),Bt,l.user.role_id<3?(e(),n("td",xt)):_("",!0),l.groups?(e(),n("td",St)):_("",!0),jt])]),t("tbody",null,[(e(!0),n(m,null,p(l.orders.data,(s,c)=>(e(),n("tr",{class:"odd",key:"order"+s.id},[t("td",null,d(s.from?s.from+c:c+1),1),t("td",Et,[t("div",{class:"avatar",style:S({backgroundImage:`url(/storage/files/${s.user.avatar})`})},null,4)]),t("td",null,d(s.user.fio),1),t("td",null,d(s.subject?s.subject.name:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),1),t("td",null,[t("div",Gt,[t("div",Lt,[s.lastEduPaid.status==1?(e(),n("div",{key:0,class:"paid success",onClick:u=>a.setPaid(s.id,0)},"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,Tt)):s.lastEduPaid.status==2?(e(),n("div",{key:1,class:"paid danger",onClick:u=>a.setPaid(s.id,1)},"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,At)):(e(),n("div",{key:2,class:"paid black",onClick:u=>a.setPaid(s.id,1)},"\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043E ",8,Dt)),t("div",Vt,d(s.lastEduPaid.date),1)])])]),l.user.role_id<3?(e(),n("td",Nt,d(s.teacher.fio),1)):_("",!0),t("td",null,[t("div",It,[t("div",Ft,d(s.user.tel_num),1)])]),l.user.role_id<3?(e(),n("td",Ut,[t("div",Mt,[t("div",Ht,[s.lastEduPaid.status==1?(e(),n("div",Kt,d(s.price.toLocaleString()),1)):s.lastEduPaid.status==2?(e(),n("div",{key:1,class:"paid pd danger no-hover",onClick:u=>a.setPaid(s.id,1)},d(s.price.toLocaleString()),9,qt)):(e(),n("div",{key:2,class:"paid pd black no-hover",onClick:u=>a.setPaid(s.id,1)},d(s.price.toLocaleString()),9,zt)),t("div",Ot,d(s.newPrice.toLocaleString()),1)])])])):_("",!0),l.groups?(e(),n(m,{key:2},[l.groups&&s.group_id!=0?(e(),n("td",Rt,[k(t("select",{class:"form-control",onChange:y(u=>a.setGroup(s.id,s.group_id),["prevent"]),"onUpdate:modelValue":u=>s.group_id=u,placeholder:"\u0411\u0435\u043B\u0441\u0435\u043D\u0434\u0456"},[Jt,Qt,(e(!0),n(m,null,p(l.groups,u=>(e(),n("option",{value:u.id},d(u.name),9,Xt))),256))],40,Wt),[[D,s.group_id]])])):(e(),n("td",Yt,[k(t("input",{type:"text",class:"form-control","onUpdate:modelValue":i[2]||(i[2]=u=>r.newGroup=u),onFocusout:u=>a.setNewGroup(s.id)},null,40,Zt),[[x,r.newGroup]])]))],64)):_("",!0),k(t("td",null,[t("div",$t,[g(v,{href:o.route("admin.users.edit",s),class:"btn btn-primary",title:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"},{default:f(()=>[ts]),_:2},1032,["href"])])],512),[[B,l.user.role_id==1||l.user.role_id==2]])]))),128)),t("tr",ss,[es,ls,ns,os,ds,is,as,t("td",null,[t("div",cs,[t("div",us,[t("div",_s,d(a.calculatePrice(1,0)),1),t("div",rs,d(a.calculatePrice(1,1)),1)])])]),hs,fs]),t("tr",ms,[vs,ks,bs,gs,ps,ys,Cs,t("td",null,[t("div",Ps,[t("div",ws,[t("div",Bs,d(a.calculatePrice(2,0)),1),t("div",xs,d(a.calculatePrice(2,1)),1)])])]),Ss,js]),t("tr",Es,[Gs,Ls,Ts,As,Ds,Vs,Ns,t("td",null,[t("div",Is,[t("div",Fs,[t("div",Us,d(a.calculateAllPrice(0)),1),t("div",Ms,d(a.calculateAllPrice(1)),1)])])]),Hs,Ks])])])])]),g(j,{links:l.orders.links},null,8,["links"])])])]),l.groups?(e(),n("div",qs,[t("div",zs,[t("div",Os,[Rs,t("div",Ws,[t("div",Js,[(e(!0),n(m,null,p(l.groups,s=>(e(),n("div",{class:"module",key:"group"+s.id},[t("div",{class:"module-header","data-toggle":"collapse","data-target":"#moduleContent_"+s.id},[t("div",Xs,[t("div",Ys,[t("h4",Zs,d(s.name),1),t("div",{class:"btn-group btn-group-sm",onClick:i[3]||(i[3]=y(()=>{},["stop"]))},[t("button",{onClick:y(c=>a.deleteData(s.id,!0),["prevent"]),class:"btn btn-danger",title:"\u0416\u043E\u044E"},se,8,$s)])]),ee])],8,Qs),t("div",{id:"moduleContent_"+s.id,class:"module-content collapse show"},[t("table",ne,[oe,t("tbody",null,[(e(!0),n(m,null,p(l.orders.data,(c,u)=>(e(),n("tr",{class:"odd",key:"grouporder"+c.id},[c.group_id==s.id?(e(),n(m,{key:0},[t("td",null,d(c.from?c.from+u:u+1),1),t("td",de,[t("div",{class:"avatar",style:S({backgroundImage:`url(/storage/files/${c.user.avatar})`})},null,4)]),t("td",null,d(c.user.fio),1),t("td",null,d(c.subject?c.subject.name:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),1),t("td",null,[t("div",ie,[t("div",ae,[c.lastEduPaid.status==1?(e(),n("div",{key:0,class:"paid success",onClick:C=>a.setPaid(c.id,0)},"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,ce)):c.lastEduPaid.status==2?(e(),n("div",{key:1,class:"paid danger",onClick:C=>a.setPaid(c.id,1)},"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,ue)):(e(),n("div",{key:2,class:"paid black",onClick:C=>a.setPaid(c.id,1)},"\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043E ",8,_e)),t("div",re,d(c.lastEduPaid.date),1)])])]),t("td",null,[t("div",he,[fe,t("button",{onClick:y(C=>a.deleteDataAtGroup(c.id),["prevent"]),class:"btn btn-danger",title:"\u0416\u043E\u044E"},ke,8,me)])])],64)):_("",!0)]))),128))])])],8,le)]))),128))])])])])])):_("",!0)]),_:1})],64)}const Pe=N(I,[["render",be]]);export{Pe as default};
