import{_ as L,A as T}from"./AdminLayout.2b845202.js";import{L as V,H as A,r as B,o as l,a as o,e as C,w as m,F as v,b as t,t as a,c as j,g as r,l as f,s as S,v as p,q as g,f as P,d as y,m as E,u as D,k as w}from"./app.f622ec8b.js";import{P as K}from"./Pagination.340edbcc.js";const U={components:{AdminLayout:T,Link:V,Pagination:K,Head:A},props:["orders","groups","user","teacher"],data(){return{filter:{studFio:route().params.studFio?route().params.studFio:null,subj:route().params.subj?route().params.subj:null,prepodFio:route().params.prepodFio?route().params.prepodFio:null,phone:route().params.phone?route().params.phone:null},loading:0,newGroup:"",allPrice:0,newAllPrice:0}},methods:{calculatePrice(d,n){return this.orders.data.reduce((h,u)=>d==2&&u.lastEduPaid.status==3||u.lastEduPaid&&u.lastEduPaid.status==d?h+(n?u.newPrice:u.price):h,0)},calculateAllPrice(d){return this.orders.data.reduce((e,h)=>e+(d?h.newPrice:h.price),0)},checkStudents(){return this.user.role_id==1?!1:this.orders.data.every(d=>d.group_id!==null)==!1},setNewGroup(d){this.$inertia.put(route("admin.students.update",d),{name:this.newGroup})},setGroup(d,n){axios.post(`/admin/students/${d}/setGroups`,{group_ids:n}).then(e=>{console.log(e.data)})},setPaid(d,n){if(n)Swal.fire({title:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u0435 \u043E\u043F\u043B\u0430\u0442\u0443",icon:"success",showCancelButton:!0,confirmButtonColor:"#71DD37",cancelButtonColor:"#adb5bd",confirmButtonText:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancelButtonText:"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C"}).then(e=>{e.isConfirmed&&this.$inertia.post(route("admin.students.paid",d))});else{if(this.orders.data.find(h=>h.id==d).lastEduPaid.is_paid)return Swal.fire({title:"\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E!",text:"\u041E\u043F\u043B\u0430\u0442\u0430 \u043D\u0435 \u043C\u043E\u0436\u0435\u0442 \u0431\u044B\u0442\u044C \u043E\u0442\u043C\u0435\u043D\u0435\u043D\u0430, \u0442\u0430\u043A \u043A\u0430\u043A \u0437\u0430\u0440\u043F\u043B\u0430\u0442\u0430 \u0431\u044B\u043B\u0430 \u0432\u044B\u0434\u0430\u043D\u0430 \u0443\u0447\u0438\u0442\u0435\u043B\u044E!",icon:"error"});Swal.fire({title:"\u041E\u0442\u043C\u0435\u043D\u0438\u0442\u044C \u043E\u043F\u043B\u0430\u0442\u0443?",icon:"error",showCancelButton:!0,confirmButtonColor:"#71DD37",cancelButtonColor:"#adb5bd",confirmButtonText:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044C",cancelButtonText:"\u041E\u0442\u043A\u043B\u043E\u043D\u0438\u0442\u044C"}).then(h=>{h.isConfirmed&&this.$inertia.post(route("admin.students.deletePaid",d))})}},search(){this.loading=1;const d=this.clearParams(this.filter);this.$inertia.get(route("admin.students.index"),d)},deleteData(d){Swal.fire({title:"\u0416\u043E\u044E\u0493\u0430 \u0441\u0435\u043D\u0456\u043C\u0434\u0456\u0441\u0456\u0437 \u0431\u0435?",text:"\u049A\u0430\u0439\u0442\u044B\u043F \u049B\u0430\u043B\u043F\u044B\u043D\u0430 \u043A\u0435\u043B\u043C\u0435\u0443\u0456 \u043C\u04AF\u043C\u043A\u0456\u043D!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u0418\u04D9, \u0436\u043E\u044F\u043C\u044B\u043D!",cancelButtonText:"\u0416\u043E\u049B"}).then(n=>{n.isConfirmed&&this.$inertia.delete(route("admin.groups.destroy",d))})},deleteDataAtGroup(d,n){Swal.fire({title:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C \u0443\u0447\u0435\u043D\u0438\u043A\u0430 \u0438\u0437 \u0433\u0440\u0443\u043F\u043F\u044B?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"\u0414\u0430!",cancelButtonText:"\u041D\u0435\u0442"}).then(e=>{e.isConfirmed&&this.$inertia.delete(route("admin.groups.destroyOrder",{id:d,groupId:n}))})}}},N=t("head",null,[t("title",null,"\u0410\u0434\u043C\u0438\u043D \u043F\u0430\u043D\u0435\u043B\u044C | \u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B")],-1),I={class:"row mb-2"},M={class:"col-sm-6"},H={class:"m-0"},q={class:"col-sm-6"},z={class:"breadcrumb float-sm-right"},O={class:"breadcrumb-item"},R=["href"],W=t("i",{class:"fas fa-dashboard"},null,-1),J=y(" \u0411\u0430\u0441\u0442\u044B \u0431\u0435\u0442 "),Q=[W,J],X=t("li",{class:"breadcrumb-item active"}," \u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B ",-1),Y={class:"buttons d-flex align-items-center"},Z=t("i",{class:"fa fa-plus"},null,-1),$=y(" \u049A\u043E\u0441\u0443 "),tt=t("i",{class:"fa fa-trash"},null,-1),st=y(" \u0424\u0438\u043B\u044C\u0442\u0440\u0434\u0456 \u0442\u0430\u0437\u0430\u043B\u0430\u0443 "),et=y(" \u041E\u0442\u0447\u0451\u0442 \u0434\u043B\u044F \u0432\u044B\u0434\u0430\u0447\u0438 \u0437\u0430\u0440\u043F\u043B\u0430\u0442\u044B "),lt=y(" \u041F\u043E\u043B\u043D\u044B\u0439 \u043E\u0442\u0447\u0451\u0442 "),ot={key:3,class:"ml-2 badge badge-danger"},nt={class:"container-fluid"},dt={class:"card"},it={class:"card-body"},at={class:"row"},ct={class:"col-sm-12"},ut={class:"table table-hover table-bordered table-striped dataTable dtr-inline"},rt={role:"row"},_t=t("th",null,"\u2116",-1),ht=t("th",null,null,-1),mt=t("th",null,"\u0424\u0418\u041E",-1),ft=t("th",null,"\u041F\u0440\u0435\u0434\u043C\u0435\u0442",-1),vt=t("th",null,"\u0421\u0442\u0430\u0442\u0443\u0441",-1),kt={key:0},bt=t("th",null,"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",-1),pt={key:1},gt={key:2},yt={class:"filters"},Ct=t("td",null,null,-1),Pt=t("td",null,null,-1),wt={key:0},Bt={key:1},jt={key:2},xt=t("td",null,null,-1),St={class:"d-f aj-c"},Et={class:"d-f j-c"},Gt={class:"paidBlock"},Ft=["onClick"],Lt=["onClick"],Tt=["onClick"],Vt={class:"paid date"},At={key:0},Dt={class:"d-f j-c"},Kt={class:"tablemask",title:"\u041D\u0430\u043F\u0438\u0441\u0430\u0442\u044C \u043F\u043E Whatsapp"},Ut={key:1},Nt={class:"d-f j-c"},It={class:"paidBlock"},Mt={key:0,class:"paid success no-hover"},Ht=["onClick"],qt=["onClick"],zt={class:"paid date no-hover"},Ot={key:0},Rt={class:"dropdown"},Wt=t("div",{class:"tablemask"},"\u0412\u044B\u0431\u0440\u0430\u0442\u044C \u0433\u0440\u0443\u043F\u043F\u0443",-1),Jt={class:"dropdown-content"},Qt=["onClick"],Xt={class:"form-group form-check item"},Yt=["id","value","onUpdate:modelValue","onChange"],Zt=["for"],$t={key:1},ts=["onKeyup"],ss={class:"btn-group btn-group-sm"},es=t("i",{class:"fas fa-edit"},null,-1),ls={key:0,class:"odd"},os=t("td",null,null,-1),ns=t("td",null,null,-1),ds=t("td",null,null,-1),is=t("td",null,null,-1),as=t("td",null,null,-1),cs=t("td",null,null,-1),us=t("td",null,"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",-1),rs={class:"d-f j-c"},_s={class:"paidBlock"},hs={class:"paid success no-hover"},ms={class:"paid date no-hover"},fs=t("td",null,null,-1),vs=t("td",null,null,-1),ks={key:1,class:"odd"},bs=t("td",null,null,-1),ps=t("td",null,null,-1),gs=t("td",null,null,-1),ys=t("td",null,null,-1),Cs=t("td",null,null,-1),Ps=t("td",null,null,-1),ws=t("td",null,"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",-1),Bs={class:"d-f j-c"},js={class:"paidBlock"},xs={class:"paid pd danger no-hover"},Ss={class:"paid date no-hover"},Es=t("td",null,null,-1),Gs=t("td",null,null,-1),Fs={key:2,class:"odd"},Ls=t("td",null,null,-1),Ts=t("td",null,null,-1),Vs=t("td",null,null,-1),As=t("td",null,null,-1),Ds=t("td",null,null,-1),Ks=t("td",null,null,-1),Us=t("td",null,"\u041E\u0431\u0449\u0435\u0435",-1),Ns={class:"d-f j-c"},Is={class:"paidBlock"},Ms={class:"paid pd success no-hover"},Hs={class:"paid date no-hover"},qs=t("td",null,null,-1),zs=t("td",null,null,-1),Os={key:0,class:"container-fluid"},Rs={class:"card"},Ws={class:"card-body"},Js=t("h2",{class:"mb-3"},"\u0413\u0440\u0443\u043F\u043F\u044B",-1),Qs={class:"row"},Xs={class:"col-sm-12"},Ys=["data-target"],Zs={class:"d-flex center"},$s={class:"d-flex gap-20"},te={class:"mr-3 modul_name"},se=["onClick"],ee=t("i",{class:"fas fa-times"},null,-1),le=[ee],oe=t("span",{class:"arrow mr-3"},"\u25BC",-1),ne=["id"],de={class:"table table-hover table-bordered table-striped dataTable dtr-inline"},ie=t("thead",null,[t("tr",{role:"row"},[t("th",null,"\u2116"),t("th"),t("th",null,"\u0424\u0418\u041E"),t("th",null,"\u041F\u0440\u0435\u0434\u043C\u0435\u0442"),t("th",null,"\u0421\u0442\u0430\u0442\u0443\u0441"),t("td")])],-1),ae={class:"d-f aj-c"},ce={class:"d-f j-c"},ue={class:"paidBlock"},re=["onClick"],_e=["onClick"],he=["onClick"],me={class:"paid date"},fe={class:"d-f j-b"},ve=t("div",null,null,-1),ke=["onClick"],be=t("i",{class:"fas fa-times"},null,-1),pe=[be];function ge(d,n,e,h,u,i){const b=B("Link"),G=B("Pagination"),F=B("AdminLayout");return l(),o(v,null,[N,C(F,null,{breadcrumbs:m(()=>{var s;return[t("div",I,[t("div",M,[t("h1",H,"\u0421\u0442\u0443\u0434\u0435\u043D\u0442\u044B "+a((s=e.teacher)==null?void 0:s.fio),1)]),t("div",q,[t("ol",z,[t("li",O,[t("a",{href:d.route("admin.index")},Q,8,R)]),X])])])]}),header:m(()=>[t("div",Y,[e.user.role_id==1||e.user.role_id==2?(l(),j(b,{key:0,class:"btn btn-primary mr-2",href:d.route("admin.users.create")},{default:m(()=>[Z,$]),_:1},8,["href"])):r("",!0),C(b,{class:"btn btn-danger",href:d.route("admin.students.index")},{default:m(()=>[tt,st]),_:1},8,["href"]),e.groups?(l(),j(b,{key:1,class:"btn btn-success ml-2",href:d.route("admin.teachers.reports",e.teacher.id)},{default:m(()=>[et]),_:1},8,["href"])):r("",!0),e.groups?(l(),j(b,{key:2,class:"btn btn-success ml-2",href:d.route("admin.teachers.fullReports",e.teacher.id)},{default:m(()=>[lt]),_:1},8,["href"])):r("",!0),i.checkStudents()?(l(),o("div",ot,[t("h3",null,a(e.groups?"\u0412\u0430\u0448\u0438":"\u041D\u0435\u043A\u043E\u0442\u043E\u0440\u044B\u0435")+" \u0441\u0442\u0443\u0434\u0435\u043D\u0442\u044B \u043D\u0435 \u0440\u0430\u0441\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u044B \u043F\u043E \u0433\u0440\u0443\u043F\u043F\u0430\u043C",1)])):r("",!0)])]),default:m(()=>[t("div",nt,[t("div",dt,[t("div",it,[t("div",at,[t("div",ct,[t("table",ut,[t("thead",null,[t("tr",rt,[_t,ht,mt,ft,vt,e.user.role_id<3?(l(),o("th",kt,"\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044C")):r("",!0),bt,e.user.role_id<3?(l(),o("th",pt,"\u0426\u0435\u043D\u0430")):r("",!0),e.groups?(l(),o("th",gt,"\u0413\u0440\u0443\u043F\u043F\u0430")):r("",!0),f(t("th",null,null,512),[[S,e.user.role_id==1||e.user.role_id==2]])]),t("tr",yt,[Ct,Pt,t("td",null,[f(t("input",{"onUpdate:modelValue":n[0]||(n[0]=s=>u.filter.studFio=s),class:"form-control",placeholder:"\u0421\u0442\u0443\u0434\u0435\u043D\u0442 \u0424\u0418\u041E",onKeyup:n[1]||(n[1]=g((...s)=>i.search&&i.search(...s),["enter"]))},null,544),[[p,u.filter.studFio]])]),t("td",null,[f(t("input",{"onUpdate:modelValue":n[2]||(n[2]=s=>u.filter.subj=s),class:"form-control",placeholder:"\u041F\u0440\u0435\u0434\u043C\u0435\u0442",onKeyup:n[3]||(n[3]=g((...s)=>i.search&&i.search(...s),["enter"]))},null,544),[[p,u.filter.subj]])]),e.user.role_id<3?(l(),o("td",wt)):r("",!0),t("td",null,[f(t("input",{"onUpdate:modelValue":n[4]||(n[4]=s=>u.filter.prepodFio=s),class:"form-control",placeholder:"\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044C \u0424\u0418\u041E",onKeyup:n[5]||(n[5]=g((...s)=>i.search&&i.search(...s),["enter"]))},null,544),[[p,u.filter.prepodFio]])]),e.user.role_id<3?(l(),o("td",Bt,[f(t("input",{"onUpdate:modelValue":n[6]||(n[6]=s=>u.filter.phone=s),class:"form-control",placeholder:"\u041D\u043E\u043C\u0435\u0440 \u0442\u0435\u043B\u0435\u0444\u043E\u043D\u0430",onKeyup:n[7]||(n[7]=g((...s)=>i.search&&i.search(...s),["enter"]))},null,544),[[p,u.filter.phone]])])):r("",!0),e.groups?(l(),o("td",jt)):r("",!0),xt])]),t("tbody",null,[(l(!0),o(v,null,P(e.orders.data,(s,c)=>(l(),o("tr",{class:"odd",key:"order"+s.id},[t("td",null,a(s.from?s.from+c:c+1),1),t("td",St,[t("div",{class:"avatar",style:E({backgroundImage:`url(/storage/files/${s.user.avatar})`})},null,4)]),t("td",null,a(s.user.fio),1),t("td",null,a(s.subject?s.subject.name:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),1),t("td",null,[t("div",Et,[t("div",Gt,[s.lastEduPaid.status==1?(l(),o("div",{key:0,class:"paid success",onClick:_=>i.setPaid(s.id,0)},"\u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,Ft)):s.lastEduPaid.status==2?(l(),o("div",{key:1,class:"paid danger",onClick:_=>i.setPaid(s.id,1)},"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,Lt)):(l(),o("div",{key:2,class:"paid black",onClick:_=>i.setPaid(s.id,1)},"\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043E ",8,Tt)),t("div",Vt,a(s.lastEduPaid.date),1)])])]),e.user.role_id<3?(l(),o("td",At,a(s.teacher.fio),1)):r("",!0),t("td",null,[t("div",Dt,[t("div",Kt,a(s.user.tel_num),1)])]),e.user.role_id<3?(l(),o("td",Ut,[t("div",Nt,[t("div",It,[s.lastEduPaid.status==1?(l(),o("div",Mt,a(s.price.toLocaleString()),1)):s.lastEduPaid.status==2?(l(),o("div",{key:1,class:"paid pd danger no-hover",onClick:_=>i.setPaid(s.id,1)},a(s.price.toLocaleString()),9,Ht)):(l(),o("div",{key:2,class:"paid pd black no-hover",onClick:_=>i.setPaid(s.id,1)},a(s.price.toLocaleString()),9,qt)),t("div",zt,a(s.newPrice.toLocaleString()),1)])])])):r("",!0),e.groups?(l(),o(v,{key:2},[s.newGroup==0?(l(),o("td",Ot,[t("div",Rt,[Wt,t("div",Jt,[t("div",{class:"pb-3 px-2 newgroup item",onClick:_=>s.newGroup=1},"\u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u0433\u0440\u0443\u043F\u043F\u0443",8,Qt),(l(!0),o(v,null,P(e.groups,(_,k)=>(l(),o("div",Xt,[f(t("input",{type:"checkbox",class:"form-check-input",id:"group_"+k+"_"+c,value:_.id,"onUpdate:modelValue":x=>s.group_ids=x,onChange:w(x=>i.setGroup(s.id,s.group_ids),["prevent"])},null,40,Yt),[[D,s.group_ids]]),t("label",{class:"form-check-label",for:"group_"+k+"_"+c},a(_.name),9,Zt)]))),256))])])])):(l(),o("td",$t,[f(t("input",{type:"text",class:"form-control","onUpdate:modelValue":n[8]||(n[8]=_=>u.newGroup=_),onKeyup:g(_=>i.setNewGroup(s.id),["enter"]),placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F \u0433\u0440\u0443\u043F\u043F\u044B"},null,40,ts),[[p,u.newGroup]])]))],64)):r("",!0),f(t("td",null,[t("div",ss,[C(b,{href:d.route("admin.users.edit",s.id),class:"btn btn-primary",title:"\u0418\u0437\u043C\u0435\u043D\u0438\u0442\u044C"},{default:m(()=>[es]),_:2},1032,["href"])])],512),[[S,e.user.role_id==1||e.user.role_id==2]])]))),128)),e.user.role_id<3?(l(),o("tr",ls,[os,ns,ds,is,as,cs,us,t("td",null,[t("div",rs,[t("div",_s,[t("div",hs,a(i.calculatePrice(1,0)),1),t("div",ms,a(i.calculatePrice(1,1)),1)])])]),fs,vs])):r("",!0),e.user.role_id<3?(l(),o("tr",ks,[bs,ps,gs,ys,Cs,Ps,ws,t("td",null,[t("div",Bs,[t("div",js,[t("div",xs,a(i.calculatePrice(2,0)),1),t("div",Ss,a(i.calculatePrice(2,1)),1)])])]),Es,Gs])):r("",!0),e.user.role_id<3?(l(),o("tr",Fs,[Ls,Ts,Vs,As,Ds,Ks,Us,t("td",null,[t("div",Ns,[t("div",Is,[t("div",Ms,a(i.calculateAllPrice(0)),1),t("div",Hs,a(i.calculateAllPrice(1)),1)])])]),qs,zs])):r("",!0)])])])]),C(G,{links:e.orders.links},null,8,["links"])])])]),e.groups?(l(),o("div",Os,[t("div",Rs,[t("div",Ws,[Js,t("div",Qs,[t("div",Xs,[(l(!0),o(v,null,P(e.groups,s=>(l(),o("div",{class:"module",key:"group"+s.id},[t("div",{class:"module-header","data-toggle":"collapse","data-target":"#moduleContent_"+s.id},[t("div",Zs,[t("div",$s,[t("h4",te,a(s.name),1),t("div",{class:"btn-group btn-group-sm",onClick:n[9]||(n[9]=w(()=>{},["stop"]))},[t("button",{onClick:w(c=>i.deleteData(s.id,!0),["prevent"]),class:"btn btn-danger",title:"\u0416\u043E\u044E"},le,8,se)])]),oe])],8,Ys),t("div",{id:"moduleContent_"+s.id,class:"module-content collapse show"},[t("table",de,[ie,t("tbody",null,[(l(!0),o(v,null,P(e.orders.data,(c,_)=>(l(),o("tr",{class:"odd",key:"grouporder"+c.id},[c.group_ids.includes(s.id)?(l(),o(v,{key:0},[t("td",null,a(c.from?c.from+_:_+1),1),t("td",ae,[t("div",{class:"avatar",style:E({backgroundImage:`url(/storage/files/${c.user.avatar})`})},null,4)]),t("td",null,a(c.user.fio),1),t("td",null,a(c.subject?c.subject.name:"\u041D\u0435\u0442 \u0434\u0430\u043D\u043D\u044B\u0445"),1),t("td",null,[t("div",ce,[t("div",ue,[c.lastEduPaid.status==1?(l(),o("div",{key:0,class:"paid success",onClick:k=>i.setPaid(c.id,0)}," \u041E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,re)):c.lastEduPaid.status==2?(l(),o("div",{key:1,class:"paid danger",onClick:k=>i.setPaid(c.id,1)},"\u041D\u0435 \u043E\u043F\u043B\u0430\u0447\u0435\u043D\u043E",8,_e)):(l(),o("div",{key:2,class:"paid black",onClick:k=>i.setPaid(c.id,1)},"\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043E ",8,he)),t("div",me,a(c.lastEduPaid.date),1)])])]),t("td",null,[t("div",fe,[ve,t("button",{onClick:w(k=>i.deleteDataAtGroup(c.id,s.id),["prevent"]),class:"btn btn-danger",title:"\u0416\u043E\u044E"},pe,8,ke)])])],64)):r("",!0)]))),128))])])],8,ne)]))),128))])])])])])):r("",!0)]),_:1})],64)}const we=L(U,[["render",ge]]);export{we as default};
