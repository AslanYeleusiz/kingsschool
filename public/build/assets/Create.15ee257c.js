import{A as C}from"./AdminLayout.20564d65.js";import{L as T,H as q,a as w,o as d,c as r,f as _,w as V,F as u,d as e,j as p,k as n,m as b,g as f,v as c,i as y,p as x,t as g,e as U}from"./app.84041795.js";import{P as O}from"./Pagination.a990d213.js";import{V as j}from"./ValidationError.193c2aef.js";import{_ as D}from"./_plugin-vue_export-helper.cdc0426e.js";const P={components:{AdminLayout:C,Link:T,Pagination:O,ValidationError:j,Head:q},props:["roles","filials","teachers","trainTypes","courseTypes","subjects"],data(){return{user:{image:"",role_id:"",filial_id:"",start_date:null},image:{file:"",preview:""},eduOrders:[{subject_id:"",teacher_id:"",course_type_id:1,train_type_id:1,price:0,start_date:null,end_date:null}],teacherOrders:this.trainTypes,iin:""}},methods:{warningText(l,t="\u0411\u0430\u0440\u043B\u044B\u049B \u0431\u0430\u0493\u0430\u043D\u0434\u0430\u0440 \u0442\u043E\u043B\u0442\u044B\u0440\u0443 \u049B\u0430\u0436\u0435\u0442!"){Swal.fire({title:l,text:t,icon:"warning",showCancelButton:!1,confirmButtonColor:"#3085d6",confirmButtonText:"\u041E\u043A\u0435\u0439!"})},deleteOrder(l){this.eduOrders.splice(l,1)},calculatePrice(l){if(!this.eduOrders[l].subject_id)return this.warningText("\u041F\u0440\u0435\u0434\u043C\u0435\u0442 \u043D\u0435 \u0432\u044B\u0431\u0440\u0430\u043D!",null);let t=this.subjects.find(a=>a.id===this.eduOrders[l].subject_id).price;return this.eduOrders[l].course_type_id&&(t+=t*this.courseTypes.find(a=>a.id===this.eduOrders[l].course_type_id).percent/100),this.eduOrders[l].train_type_id&&(t+=t*this.trainTypes.find(a=>a.id===this.eduOrders[l].train_type_id).percent/100),this.eduOrders[l].price=t},add28Days(l){if(this.eduOrders[l].start_date){const t=new Date(this.eduOrders[l].start_date),a=new Date(t.getTime()+28*24*60*60*1e3);this.eduOrders[l].end_date=a.toISOString().split("T")[0]}else console.error("\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0434\u0430\u0442\u0443")},addEduOrder(){const l={subject_id:"",teacher_id:"",course_type_id:1,train_type_id:1,price:0,start_date:null,end_date:null};this.eduOrders.push(l)},submit(){if(this.user.iin=this.iin,this.image.file&&(this.user.image=this.image.file),!this.user.role_id)return this.warningText("\u0420\u043E\u043B\u044C \u0442\u0430\u043D\u0434\u0430\u043B\u043C\u0430\u0434\u044B!");if(!this.user.filial_id)return this.warningText("\u0424\u0438\u043B\u0438\u0430\u043B \u0442\u0430\u043D\u0434\u0430\u043B\u043C\u0430\u0434\u044B!");this.user.role_id==4&&(this.user.eduOrders=this.eduOrders),this.user.role_id==3&&(this.user.eduOrders=this.teacherOrders),this.$inertia.post(route("admin.users.store"),this.user,{onError:()=>console.log("An error has occurred"),onSuccess:()=>console.log("The new contact has been saved")})},handleImageUpload(){if(this.image.file=this.$refs.image.files[0],this.image.file){const l=new FileReader;l.onloadend=t=>{this.image.preview=l.result},l.readAsDataURL(this.image.file),this.$refs.image.value=""}else this.user.image="",this.image.file="",this.image.preview=""},checkIin(){this.warningText("\u0411\u04B1\u043D\u0434\u0430\u0439 \u0418\u0418\u041D \u0431\u04B1\u0440\u044B\u043D \u0442\u0456\u0440\u043A\u0435\u043B\u0433\u0435\u043D",null)}},watch:{iin(l){l.length===12&&this.checkIin()}}},S=e("head",null,[e("title",null,"\u0410\u0434\u043C\u0438\u043D \u043F\u0430\u043D\u0435\u043B\u044C | \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443")],-1),L={class:"row mb-2"},A=e("div",{class:"col-sm-6"},[e("h1",{class:"m-0"},"\u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443")],-1),B={class:"col-sm-6"},E={class:"breadcrumb float-sm-right"},I={class:"breadcrumb-item"},N=["href"],F=e("i",{class:"fas fa-dashboard"},null,-1),M=U(" \u0411\u0430\u0441\u0442\u044B \u0431\u0435\u0442 "),H=[F,M],R={class:"breadcrumb-item"},z=["href"],G=e("i",{class:"fas fa-dashboard"},null,-1),J=U(" \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u0442\u0456\u0437\u0456\u043C\u0456 "),K=[G,J],Q=e("li",{class:"breadcrumb-item active"}," \u049A\u043E\u043B\u0434\u0430\u043D\u0443\u0448\u044B \u049B\u043E\u0441\u0443 ",-1),W={class:"container-fluid"},X={class:"card card-primary"},Y={class:"card-body"},Z={class:"row"},$={class:"col-md-4"},ee={class:"form-group"},se=e("label",{for:""},"\u0420\u043E\u043B\u044C",-1),te=e("option",{value:"",hidden:""}," \u0420\u043E\u043B\u044C \u0442\u0430\u04A3\u0434\u0430\u04A3\u044B\u0437 ",-1),oe=["value"],ie={class:"col-md-4"},le={class:"form-group"},de=e("label",{for:""},"\u0424\u0438\u043B\u043B\u0438\u0430\u043B",-1),re=e("option",{value:"",hidden:"",disabled:"",selected:""}," \u0424\u0438\u043B\u043B\u0438\u0430\u043B \u0442\u0430\u04A3\u0434\u0430\u04A3\u044B\u0437 ",-1),ne=["value"],ae={class:"col-md-4"},ce={class:"form-group"},_e=e("label",{for:""},"\u049A\u04B1\u043F\u0438\u044F \u0441\u04E9\u0437",-1),ue={class:"row"},me={class:"col-md-4"},he={class:"form-group"},pe=e("label",{for:""},"\u0418\u0418\u041D",-1),fe={class:"row"},ve={class:"col-md-4"},ge={class:"form-group"},be=e("label",{for:""},"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",-1),ye={class:"col-md-4"},we={class:"form-group"},Ve=e("label",{for:""},"\u0418\u043C\u044F",-1),Ue={class:"row"},ke={class:"col-md-4"},Ce={class:"form-group"},Te=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u0440\u043E\u0436\u0434\u0435\u043D\u044C\u044F",-1),qe={class:"col-md-4"},xe={class:"form-group"},Oe=e("label",{for:""},"\u0422\u0435\u043B\u0435\u0444\u043E\u043D",-1),je={class:"col-md-4"},De={class:"form-group"},Pe=e("label",{for:""},"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B\u044F",-1),Se={class:"form-group file-upload"},Le=e("label",{for:""},"\u0421\u0443\u0440\u0435\u0442",-1),Ae={class:"ml-2"},Be=["src"],Ee=["src"],Ie={class:"file-input",style:{"margin-right":"10px"}},Ne=e("label",{for:"image"}," \u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C ",-1),Fe={key:0,class:"mt-5"},Me=e("hr",null,null,-1),He={class:"row"},Re={class:"col-md-4"},ze={class:"form-group"},Ge=e("label",{for:""},"\u041F\u0440\u0435\u0434\u043C\u0435\u0442",-1),Je=["onChange","onUpdate:modelValue"],Ke=e("option",{value:"",hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),Qe=["value"],We={class:"col-md-4"},Xe={class:"form-group"},Ye=e("label",{for:""},"\u041F\u0440\u0435\u043F\u043E\u0434\u0430\u0432\u0430\u0442\u0435\u043B\u044C",-1),Ze=["onUpdate:modelValue"],$e=e("option",{value:"",hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),es=["value"],ss={class:"row"},ts={class:"col-md-4"},os={class:"form-group"},is=e("label",{for:""},"\u041A\u0443\u0440\u0441",-1),ls=["onChange","onUpdate:modelValue"],ds=e("option",{value:null,hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),rs=["value"],ns={class:"col-md-4"},as={class:"form-group"},cs=e("label",{for:""},"\u041E\u0431\u0443\u0447\u0435\u043D\u0438\u0435",-1),_s=["onChange","onUpdate:modelValue"],us=e("option",{value:null,hidden:""}," \u0412\u044B\u0431\u0440\u0430\u0442\u044C ",-1),ms=["value"],hs={class:"col-md-4"},ps={class:"form-group"},fs=e("label",{for:""},"\u0426\u0435\u043D\u0430",-1),vs=["onUpdate:modelValue"],gs={class:"row"},bs={class:"col-md-4"},ys={class:"form-group"},ws=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u043E \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),Vs=["onChange","onUpdate:modelValue"],Us={class:"col-md-4"},ks={class:"form-group"},Cs=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043A\u043E\u043D\u0446\u0430 \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),Ts=["onUpdate:modelValue"],qs={class:"d-flex justify-content-end"},xs=["onClick"],Os=e("i",{class:"fas fa-times"},null,-1),js=[Os],Ds={class:"row"},Ps={class:"col-md-5"},Ss={class:"form-group"},Ls=e("label",{for:""},"\u0414\u0430\u0442\u0430 \u043D\u0430\u0447\u0430\u043B\u043E \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F",-1),As={class:"row"},Bs={class:"col-md-5"},Es={class:"form-group"},Is=e("label",{for:""},"\u0417\u0430\u0440\u043F\u043B\u0430\u0442\u0430",-1),Ns={class:"input-group mt-3"},Fs={class:"input-group-prepend"},Ms={class:"input-group-text",id:"basic-addon3"},Hs=["onUpdate:modelValue"],Rs=e("div",{class:"input-group-append"},[e("span",{class:"input-group-text"},"%")],-1),zs={class:"card-footer mt-5"},Gs=e("button",{type:"submit",class:"btn btn-success mr-1"}," \u0421\u0430\u049B\u0442\u0430\u0443 ",-1);function Js(l,t,a,Ks,i,h){const m=w("validation-error"),k=w("AdminLayout");return d(),r(u,null,[S,_(k,null,{breadcrumbs:V(()=>[e("div",L,[A,e("div",B,[e("ol",E,[e("li",I,[e("a",{href:l.route("admin.index")},H,8,N)]),e("li",R,[e("a",{href:l.route("admin.users.index")},K,8,z)]),Q])])])]),default:V(()=>[e("div",W,[e("div",X,[e("form",{method:"post",onSubmit:t[13]||(t[13]=p((...s)=>h.submit&&h.submit(...s),["prevent"]))},[e("div",Y,[e("div",Z,[e("div",$,[e("div",ee,[se,n(e("select",{class:"form-control","onUpdate:modelValue":t[0]||(t[0]=s=>i.user.role_id=s),placeholder:"\u0411\u0435\u043B\u0441\u0435\u043D\u0434\u0456",required:""},[te,(d(!0),r(u,null,f(a.roles,s=>(d(),r("option",{key:"role"+s.id,value:s.id},g(s.name),9,oe))),128))],512),[[b,i.user.role_id]]),_(m,{field:"role_id"})])]),e("div",ie,[e("div",le,[de,n(e("select",{class:"form-control","onUpdate:modelValue":t[1]||(t[1]=s=>i.user.filial_id=s),placeholder:"\u0411\u0435\u043B\u0441\u0435\u043D\u0434\u0456",required:""},[re,(d(!0),r(u,null,f(a.filials,s=>(d(),r("option",{key:"filial"+s.id,value:s.id},g(s.name),9,ne))),128))],512),[[b,i.user.filial_id]]),_(m,{field:"filial_id"})])]),e("div",ae,[e("div",ce,[_e,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=s=>i.user.real_password=s),name:"real_password",placeholder:"\u049A\u04B1\u043F\u0438\u044F \u0441\u04E9\u0437"},null,512),[[c,i.user.real_password]]),_(m,{field:"real_password"})])])]),e("div",ue,[e("div",me,[e("div",he,[pe,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=s=>i.iin=s),name:"iin",placeholder:"\u0418\u0418\u041D",required:""},null,512),[[c,i.iin]]),_(m,{field:"iin"})])])]),e("div",fe,[e("div",ve,[e("div",ge,[be,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[4]||(t[4]=s=>i.user.s_name=s),name:"s_name",placeholder:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",required:""},null,512),[[c,i.user.s_name]]),_(m,{field:"s_name"})])]),e("div",ye,[e("div",we,[Ve,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[5]||(t[5]=s=>i.user.name=s),name:"name",placeholder:"\u0418\u043C\u044F",required:""},null,512),[[c,i.user.name]]),_(m,{field:"name"})])])]),e("div",Ue,[e("div",ke,[e("div",Ce,[Te,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[6]||(t[6]=s=>i.user.birthday=s),name:"birthday",placeholder:"\u0424\u0430\u043C\u0438\u043B\u0438\u044F",required:""},null,512),[[c,i.user.birthday]]),_(m,{field:"birthday"})])]),e("div",qe,[e("div",xe,[Oe,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[7]||(t[7]=s=>i.user.tel_num=s),name:"tel_num",placeholder:"\u0418\u043C\u044F",required:""},null,512),[[c,i.user.tel_num]]),_(m,{field:"tel_num"})])]),e("div",je,[e("div",De,[Pe,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[8]||(t[8]=s=>i.user.tel_num_family=s),name:"tel_num_family",placeholder:"\u0422\u0435\u043B\u0435\u0444\u043E\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B\u044F"},null,512),[[c,i.user.tel_num_family]]),_(m,{field:"tel_num_family"})])])]),e("div",Se,[Le,e("div",Ae,[i.user.image&&!i.image.file?(d(),r("img",{key:0,src:l.route("index")+"/storage/images/"+i.user.image,height:"300",alt:"image",style:{"padding-bottom":"10px"}},null,8,Be)):y("",!0),n(e("img",{src:i.image.preview,height:"300",style:{"padding-bottom":"10px"}},null,8,Ee),[[x,i.image.preview]]),e("div",Ie,[e("input",{type:"file",hidden:"",name:"image",onChange:t[9]||(t[9]=s=>h.handleImageUpload()),ref:"image",accept:"image/jpeg,image/png",class:"file",id:"image"},null,544),Ne])]),_(m,{field:"image"})]),i.user.role_id==3||i.user.role_id==4?(d(),r("h2",Fe,"\u041E\u0431\u0443\u0447\u0435\u043D\u0438\u0435")):y("",!0),i.user.role_id==4?(d(!0),r(u,{key:1},f(i.eduOrders,(s,v)=>(d(),r(u,null,[Me,e("div",He,[e("div",Re,[e("div",ze,[Ge,n(e("select",{class:"form-control",onChange:p(o=>h.calculatePrice(v),["prevent"]),"onUpdate:modelValue":o=>s.subject_id=o,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[Ke,(d(!0),r(u,null,f(a.subjects,o=>(d(),r("option",{key:"subject"+o.id,value:o.id},g(o.name),9,Qe))),128))],40,Je),[[b,s.subject_id]])])]),e("div",We,[e("div",Xe,[Ye,n(e("select",{class:"form-control","onUpdate:modelValue":o=>s.teacher_id=o,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[$e,(d(!0),r(u,null,f(a.teachers,o=>(d(),r("option",{key:"teacher"+o.id,value:o.id},g(o.fio),9,es))),128))],8,Ze),[[b,s.teacher_id]])])])]),e("div",ss,[e("div",ts,[e("div",os,[is,n(e("select",{class:"form-control",onChange:p(o=>h.calculatePrice(v),["prevent"]),"onUpdate:modelValue":o=>s.course_type_id=o,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[ds,(d(!0),r(u,null,f(a.courseTypes,o=>(d(),r("option",{key:"courseType"+o.id,value:o.id},g(o.name),9,rs))),128))],40,ls),[[b,s.course_type_id]])])]),e("div",ns,[e("div",as,[cs,n(e("select",{class:"form-control",onChange:p(o=>h.calculatePrice(v),["prevent"]),"onUpdate:modelValue":o=>s.train_type_id=o,placeholder:"\u0412\u044B\u0431\u0440\u0430\u0442\u044C",required:""},[us,(d(!0),r(u,null,f(a.trainTypes,o=>(d(),r("option",{key:"trainType"+o.id,value:o.id},g(o.name),9,ms))),128))],40,_s),[[b,s.train_type_id]])])]),e("div",hs,[e("div",ps,[fs,n(e("input",{type:"text",class:"form-control","onUpdate:modelValue":o=>s.price=o,name:"eduOrderPrice",placeholder:"\u0426\u0435\u043D\u0430"},null,8,vs),[[c,s.price]])])])]),e("div",gs,[e("div",bs,[e("div",ys,[ws,n(e("input",{type:"date",class:"form-control",onChange:p(o=>h.add28Days(v),["prevent"]),"onUpdate:modelValue":o=>s.start_date=o,name:"eduOrderPrice",required:""},null,40,Vs),[[c,s.start_date]])])]),e("div",Us,[e("div",ks,[Cs,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":o=>s.end_date=o,name:"eduOrderPrice",required:""},null,8,Ts),[[c,s.end_date]])])])]),e("div",qs,[e("button",{onClick:p(o=>h.deleteOrder(v),["prevent"]),class:"btn btn-danger mt-4"},js,8,xs)]),e("button",{onClick:t[10]||(t[10]=p(o=>h.addEduOrder(),["prevent"])),class:"btn btn-primary mt-4"}," + \u0414\u043E\u0431\u0430\u0432\u0438\u0442\u044C \u043E\u0431\u0443\u0447\u0435\u043D\u0438\u044F ")],64))),256)):y("",!0),i.user.role_id==3?(d(),r(u,{key:2},[e("div",Ds,[e("div",Ps,[e("div",Ss,[Ls,n(e("input",{type:"date",class:"form-control","onUpdate:modelValue":t[11]||(t[11]=s=>i.user.start_date=s),required:""},null,512),[[c,i.user.start_date]])])])]),e("div",As,[e("div",Bs,[e("div",Es,[Is,(d(!0),r(u,null,f(i.teacherOrders,s=>(d(),r("div",Ns,[e("div",Fs,[e("span",Ms,g(s.name),1)]),n(e("input",{type:"number",class:"form-control","onUpdate:modelValue":v=>s.percent=v,"aria-describedby":"basic-addon3",style:{"text-align":"right"},required:""},null,8,Hs),[[c,s.percent]]),Rs]))),256))])])])],64)):y("",!0),e("div",zs,[Gs,e("button",{type:"button",class:"btn btn-danger",onClick:t[12]||(t[12]=p(s=>l.back(),["prevent"]))}," \u0410\u0440\u0442\u049B\u0430 ")])])],32)])])]),_:1})],64)}const $s=D(P,[["render",Js]]);export{$s as default};
