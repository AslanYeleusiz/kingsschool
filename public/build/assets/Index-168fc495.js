import{_ as L,A as B}from"./AdminLayout-a3b7c70b.js";import{L as T,r as w,o as e,c as v,w as g,a as t,e as n,t as i,h as b,F as m,i as p,d as y,m as C,g as x,j as D,f as h,b as O}from"./app-d2a1545d.js";const V={props:["user"],components:{AdminLayout:B,Link:T},data(){return{days:["Понедельник","Вторник","Среда","Четверг","Пятница","Суббота","Воскресение"],schedules:null,startweekdate:null,endweekdate:null,currentDate:null,dayOfWeek:null}},mounted(){this.$nextTick(()=>{console.log("Next tick executed");const c=$(this.$refs.calendar);moment.updateLocale("en",{week:{dow:1}}),c.datetimepicker({locale:"en",format:"YYYY-MM-DD",inline:!0}),c.on("change.datetimepicker",l=>{this.toggleCollapse(l.date.format("YYYY-MM-DD"))})});var a=new Date,r=a.getDay();console.log(a.toLocaleString());var d=r===0?7:r;console.log(d),this.toggleCollapse(a.toLocaleString().slice(0,10))},methods:{changeStatus(a,r){axios.post(route("admin.schedule.setStatus",a),{status:r}).then(d=>{console.log(d)})},toggleCollapse(a){console.log(a);let d=new URLSearchParams(window.location.search).get("teacher_id");axios.get(route("admin.schedule.getSchedule"),{params:{date:a,teacher_id:d??null}}).then(c=>{console.log(c),this.schedules=c.data.schedules,this.startweekdate=c.data.startweekdate,this.endweekdate=c.data.endweekdate,this.currentDate=c.data.currentDate,this.dayOfWeek=c.data.dayOfWeek})},getBadgeClass(a){switch(a){case 0:return"badge-light";case 1:return"badge-success";case 2:return"badge-danger";case 3:return"badge-warning"}},getStatusText(a){switch(a){case 0:return"Урок не начался";case 1:return"Урок проведён";case 2:return"Урок не проведён";case 3:return"Ещё не пришел"}},deleteData(a){Swal.fire({title:"Уверены, что хотите удалить?",text:"Возможно, что нельзя будет восстановить!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Да, удалю!",cancelButtonText:"Отмена"}).then(r=>{r.isConfirmed&&axios.delete(route("admin.schedule.destroy",a)).catch(d=>{var c=new Date;this.toggleCollapse(c.toLocaleString().slice(0,10))})})}}},W={class:"card"},Y={class:"row"},j={class:"col-md-4"},M=t("div",{class:"card-header border-0"},[t("h3",{class:"card-title"},[t("i",{class:"far fa-calendar-alt"}),y(" Calendar ")])],-1),N={class:"card-body pt-0"},U={ref:"calendar"},A={key:0,class:"col-md-8"},P={class:"card-body"},F={class:"d-f a-c j-b"},z={class:"mb-3"},E=y(" Изменить "),I={class:"row"},R={class:"col-sm-12"},q={class:"p-0",style:{}},G={class:"table mt-2 mb-3 table-hover table-bordered table-striped dataTable dtr-inline"},H={key:0},J={key:1},K=["onChange","onUpdate:modelValue"],Q=t("option",{value:0}," Урок не начался ",-1),X=t("option",{value:1}," Урок проведён ",-1),Z=t("option",{value:2}," Урок не проведён ",-1),tt=t("option",{value:3}," Ещё не пришел ",-1),et=[Q,X,Z,tt],st={class:"btn-group btn-group-sm"},at=["onClick"],ot=t("i",{class:"fas fa-trash"},null,-1),nt=[ot],lt=["onClick"],dt=t("i",{class:"fas fa-edit"},null,-1),it=[dt],ct=["onClick"],rt=t("i",{class:"fas fa-check"},null,-1),_t=[rt],ut=t("i",{class:"fas fa-list"},null,-1),ht={key:0,class:"container-fluid mt-4"},bt={class:"card"},mt={class:"card-body"},ft={class:"mb-3"},gt={class:"row"},kt={class:"col-sm-12"},vt={class:"table table-hover"},yt={"data-widget":"expandable-table","aria-expanded":"true"},pt={class:"d-flex justify-content-between"},wt=y(" Изменить "),Ct={class:"expandable-body"},xt={class:"p-0",style:{}},Dt={class:"table mt-2 mb-3 table-hover table-bordered table-striped dataTable dtr-inline"},St={key:0},Lt={key:1},Bt=["onChange","onUpdate:modelValue"],Tt=t("option",{value:0}," Урок не начался ",-1),Ot=t("option",{value:1}," Урок проведён ",-1),Vt=t("option",{value:2}," Урок не проведён ",-1),Wt=t("option",{value:3}," Ещё не пришел ",-1),Yt=[Tt,Ot,Vt,Wt],jt={class:"btn-group btn-group-sm"},Mt=["onClick"],Nt=t("i",{class:"fas fa-trash"},null,-1),Ut=[Nt],At=["onClick"],Pt=t("i",{class:"fas fa-edit"},null,-1),Ft=[Pt],zt=["onClick"],Et=t("i",{class:"fas fa-check"},null,-1),It=[Et],Rt=t("i",{class:"fas fa-list"},null,-1);function qt(a,r,d,c,l,_){const k=w("Link"),S=w("AdminLayout");return e(),v(S,null,{default:g(()=>[t("div",W,[t("div",Y,[t("div",j,[M,t("div",N,[t("div",U,null,512)])]),l.schedules?(e(),n("div",A,[t("div",P,[t("div",F,[t("h3",z,i(l.days[l.dayOfWeek-1])+", "+i(l.currentDate),1),d.user.role_id==1||d.user.role_id==2||d.user.role_id==3?(e(),v(k,{key:0,href:a.route("admin.schedule.create",{date:l.startweekdate,day:l.dayOfWeek}),class:"btn btn-primary",title:"Өзгерту"},{default:g(()=>[E]),_:1},8,["href"])):b("",!0)]),t("div",I,[t("div",R,[t("div",q,[t("table",G,[t("tbody",null,[(e(!0),n(m,null,p(l.schedules,s=>(e(),n("tr",{class:"odd",key:"schedule"+s.id},[s.day==l.dayOfWeek?(e(),n(m,{key:0},[t("td",null,i(s.start_time)+" - "+i(s.end_time),1),t("td",null,i(s.teacher.fio),1),t("td",null,i(s.group?s.group.name:"Вне группы"),1),s.edit?(e(),n("td",J,[x(t("select",{class:"form-control",onChange:h(u=>_.changeStatus(s.id,s.status),["prevent"]),"onUpdate:modelValue":u=>s.status=u,placeholder:"Белсенді"},et,40,K),[[D,s.status]])])):(e(),n("td",H,[t("span",{class:C(["badge badge-success",_.getBadgeClass(s.status)])},i(_.getStatusText(s.status)),3)])),t("td",null,[t("div",st,[t("button",{onClick:h(u=>_.deleteData(s.id),["prevent"]),class:"btn btn-danger",title:"Жою"},nt,8,at),s.edit?(e(),n("button",{key:1,onClick:h(u=>s.edit=0,["prevent"]),class:"btn btn-success",title:"Применить изменения"},_t,8,ct)):(e(),n("button",{key:0,onClick:h(u=>s.edit=1,["prevent"]),class:"btn btn-primary",title:"Изменить"},it,8,lt)),O(k,{href:a.route("admin.journal.index",s.id),class:"btn btn-success",title:"Журнал"},{default:g(()=>[ut]),_:2},1032,["href"])])])],64)):b("",!0)]))),128))])])])])])])])):b("",!0)])]),l.schedules?(e(),n("div",ht,[t("div",bt,[t("div",mt,[t("h3",ft,"Расписания недели "+i(l.startweekdate+"-"+l.endweekdate),1),t("div",gt,[t("div",kt,[t("table",vt,[t("tbody",null,[(e(!0),n(m,null,p(l.days,(s,u)=>(e(),n(m,null,[t("tr",yt,[t("td",null,[t("div",pt,[y(i(s)+" ",1),d.user.role_id<=3?(e(),v(k,{key:0,href:a.route("admin.schedule.create",{date:l.startweekdate,day:u+1}),class:"btn btn-primary",title:"Өзгерту"},{default:g(()=>[wt]),_:2},1032,["href"])):b("",!0)])])]),t("tr",Ct,[t("td",null,[t("div",xt,[t("table",Dt,[t("tbody",null,[(e(!0),n(m,null,p(l.schedules,o=>(e(),n("tr",{class:"odd",key:"schedule"+o.id},[o.day==u+1?(e(),n(m,{key:0},[t("td",null,i(o.start_time)+" - "+i(o.end_time),1),t("td",null,i(o.teacher.fio),1),t("td",null,i(o.group?o.group.name:"Вне группы"),1),o.edit?(e(),n("td",Lt,[x(t("select",{class:"form-control",onChange:h(f=>_.changeStatus(o.id,o.status),["prevent"]),"onUpdate:modelValue":f=>o.status=f,placeholder:"Белсенді"},Yt,40,Bt),[[D,o.status]])])):(e(),n("td",St,[t("span",{class:C(["badge badge-success",_.getBadgeClass(o.status)])},i(_.getStatusText(o.status)),3)])),t("td",null,[t("div",jt,[t("button",{onClick:h(f=>_.deleteData(o.id),["prevent"]),class:"btn btn-danger",title:"Жою"},Ut,8,Mt),o.edit?(e(),n("button",{key:1,onClick:h(f=>o.edit=0,["prevent"]),class:"btn btn-success",title:"Применить изменения"},It,8,zt)):(e(),n("button",{key:0,onClick:h(f=>o.edit=1,["prevent"]),class:"btn btn-primary",title:"Изменить"},Ft,8,At)),d.user.role_id==1||d.user.role_id==2||d.user.role_id==3?(e(),v(k,{key:2,href:a.route("admin.journal.index",o.id),class:"btn btn-success",title:"Журнал"},{default:g(()=>[Rt]),_:2},1032,["href"])):b("",!0)])])],64)):b("",!0)]))),128))])])])])])],64))),256))])])])])])])])):b("",!0)]),_:1})}const Jt=L(V,[["render",qt]]);export{Jt as default};
